BEGIN TRANSACTION;
GO

CREATE TABLE [TB_LANCAMENTOCATEGORIAS] (
    [LancamentoId] int NOT NULL,
    [CategoriaId] int NOT NULL,
    CONSTRAINT [PK_TB_LANCAMENTOCATEGORIAS] PRIMARY KEY ([LancamentoId], [CategoriaId]),
    CONSTRAINT [FK_TB_LANCAMENTOCATEGORIAS_TB_CATEGORIAS_CategoriaId] FOREIGN KEY ([CategoriaId]) REFERENCES [TB_CATEGORIAS] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_TB_LANCAMENTOCATEGORIAS_TB_LANCAMENTOS_LancamentoId] FOREIGN KEY ([LancamentoId]) REFERENCES [TB_LANCAMENTOS] ([Id]) ON DELETE CASCADE
);
GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'CategoriaId', N'LancamentoId') AND [object_id] = OBJECT_ID(N'[TB_LANCAMENTOCATEGORIAS]'))
    SET IDENTITY_INSERT [TB_LANCAMENTOCATEGORIAS] ON;
INSERT INTO [TB_LANCAMENTOCATEGORIAS] ([CategoriaId], [LancamentoId])
VALUES (1, 1),
(2, 2);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'CategoriaId', N'LancamentoId') AND [object_id] = OBJECT_ID(N'[TB_LANCAMENTOCATEGORIAS]'))
    SET IDENTITY_INSERT [TB_LANCAMENTOCATEGORIAS] OFF;
GO

UPDATE [TB_USUARIOS] SET [PasswordHash] = 0xA2C0123D56B6EF24D04C6672C7B8439270302B79332E2837242BFBB70B12021D2AF598DEBB2DC8827A4FC0B56729F8A5F1D12C970C58241631C335C86D4E836D, [PasswordSalt] = 0xC8DB6A3E2237FBBC1DAFC47F86F28D7B5EB3ED114002D60107A6E2F4BBF6F389AE13972C018944A48AEEF17462144D8861BFDA5D693D20C8AD92CCFBD71C9CD41176AADFA2DDFF3A26EA03C2D2A85059489496BD76681BB241EB739FADE70766EEBD1987A75C082E8CBB39AC1F97D35AB30871235CE3E6E044B6F7637E9F5C7A
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

CREATE INDEX [IX_TB_LANCAMENTOCATEGORIAS_CategoriaId] ON [TB_LANCAMENTOCATEGORIAS] ([CategoriaId]);
GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20231212140654_MigracaoLancamentoCategoria', N'7.0.11');
GO

COMMIT;
GO

